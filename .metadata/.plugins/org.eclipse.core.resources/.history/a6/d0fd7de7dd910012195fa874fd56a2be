package databaseOps;

import java.sql.SQLException;
import java.sql.Statement;

import models.IDbModel;

public class Update extends DatabaseOp{

	private Update(IDbModel table)
			throws IllegalArgumentException, IllegalAccessException, InstantiationException {
		super(table);
	}

	public static Update set(Statement sql, IDbModel table) throws IllegalArgumentException, IllegalAccessException, SQLException, InstantiationException{
		return new Update(table);
	}

	@Override
	public QueryResult execute(Statement stmt) throws SQLException {
		sql = "update "+tableName+" set ";
		
		sql += columns()+" ";
		
		sql += "values "+values()+" "+whereStr;
		
		//save results
		QueryResult result = new QueryResult();
		result.sql = sql;
		result.resultSet = stmt.executeQuery(sql);
		return result;
	}
}
