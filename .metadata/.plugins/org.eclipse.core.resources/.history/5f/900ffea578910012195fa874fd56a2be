package databaseOps;

import java.sql.*;

import models.IDbModel;

public class Insert extends DatabaseOp{
	
	private Insert(Statement sql, IDbModel table) throws IllegalArgumentException, IllegalAccessException {
		super(sql, table);
	}

	public static ResultSet into(Statement sql, IDbModel table) throws IllegalArgumentException, IllegalAccessException, SQLException{
			Insert op = new Insert(sql, table);
			return op.execute();
	}
	
	public ResultSet execute() throws SQLException {
		stmt = "insert into "+tableName;
		
		for (String column : columns()){
			stmt += column+",";
		}
		
		removeLastComma();
		
		for (String value : values()){
			stmt += value+",";
		}
		
		removeLastComma();
		return sql.executeQuery(stmt);
	}
}
