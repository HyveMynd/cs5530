package cs5530;

import java.sql.Statement;
import java.util.ArrayList;
import java.util.Collection;
import java.util.HashMap;
import java.util.Iterator;

import databaseOps.Insert;
import databaseOps.OP;
import databaseOps.Select;

import models.Orders;
import models.Video;

public class OrderOperations {

	public void orderVideos(Statement stmt, String id, String[] videos,
			String ccNum) throws Exception {
		
		// Map representing video, quantity
		HashMap<String, String> selections = new HashMap<String, String>();
		
		for (String video : videos){
			String[] selection = video.split(",");
			selections.put(selection[0], selection[1]);
		}
		Video video = new Video();
		double total = 0;
		for (Iterator<String> it = selections.keySet().iterator(); it.hasNext();){
			Collection<Video> vid = Select.from(video)
					.where("ISBN", OP.Equal, it.next())
					.execute(stmt).queryResults;
			String p = vid.iterator().next().Price;
			total += Double.parseDouble(p);
		}
		Orders order = new Orders();
		order.ccNum = ccNum;
		order.total = total.ToString();
		Insert.from(order)
	}

}
