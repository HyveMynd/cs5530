package cs5530;

import java.sql.ResultSet;
import java.sql.Statement;
import java.util.ArrayList;

import models.Video;
import databaseOps.Insert;
import databaseOps.QueryResult;
import databaseOps.Select;

public class VideoOperations {
	
	public String addVideo(Statement stmt, Video video) throws Exception{
		String query = "";
		String resultstr="";
		QueryResult result;
		ResultSet results;
				
		try{
			result = Insert.from(video).execute(stmt);
			results = result.stmt.getResultSet();
			query = result.sql;
        } catch(Exception e) {
			System.err.println("Unable to execute query: "+ query);
	                System.err.println(e.getMessage());
			throw(e);
		}
		System.out.println("Videos: addVideo query="+query+"\n");
		resultstr = "Successfully added video. Resutlts: "+results;
		return resultstr;
	}
	
	public OperationResult allVideos(Statement stmt, Video video) throws Exception{
		String query = "";
		String resultstr="";
		QueryResult result;
		ResultSet results;
		ArrayList<Video> videos =  new ArrayList<Video>();
				
		try{
			result = Select.from(video).execute(stmt);
			results = result.stmt.getResultSet();
			query = result.sql;
        } catch(Exception e) {
			System.err.println("Unable to execute query: "+ query);
	                System.err.println(e.getMessage());
			throw(e);
		}
		System.out.println("Videos: allVideo query="+query+"\n");
		while (results.next()){
			video.isbn = results.getString("ISBN");
			video.title = results.getString("Title");
			video.subject = results.getString("Subject");
			video.rating = results.getString("Rating");
			video.price = results.getString("Price");
			video.format = results.getString("Format");
			video.yearOfProduction = results.getString("YearOfProduction");
			resultstr += 
					"ISBN: "+video.isbn+"\n"+
					"Title: "+video.title+"\n"+
					"Subject: "+video.subject+"\n"+
					"Rating: "+video.rating+"\n"+
					"Price: "+video.price+"\n"+
					"Format: "+video.format +"\n"+
					"Year of Poduction: "+ video.yearOfProduction+"\n\n";
		}
		return resultstr;
	}
}
